"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[7269],{3873:e=>{e.exports=JSON.parse('{"permalink":"/blog/nextjs-rsc-cve","editUrl":"https://github.com/ShigureDD/shiguredd.github.io/tree/master/blog/2025-12-09-nextjs-rsc-cve.md","source":"@site/blog/2025-12-09-nextjs-rsc-cve.md","title":"Critical Security Vulnerability in Next.js","description":"ritical vulnerability has been identified in the React Server Components in Next.js","date":"2025-12-09T00:00:00.000Z","tags":[{"inline":true,"label":"next.js","permalink":"/blog/tags/next-js"},{"inline":true,"label":"cve","permalink":"/blog/tags/cve"},{"inline":true,"label":"rsc","permalink":"/blog/tags/rsc"}],"readingTime":2.99,"hasTruncateMarker":false,"authors":[{"name":"Tom Lam","title":"Software Developer","url":"https://github.com/ShigureDD","image_url":"https://github.com/ShigureDD.png","imageURL":"https://github.com/ShigureDD.png","socials":{},"key":null,"page":null}],"frontMatter":{"title":"Critical Security Vulnerability in Next.js","slug":"nextjs-rsc-cve","authors":[{"name":"Tom Lam","title":"Software Developer","url":"https://github.com/ShigureDD","image_url":"https://github.com/ShigureDD.png","imageURL":"https://github.com/ShigureDD.png"}],"tags":["next.js","cve","rsc"],"date":"2025-12-09 GMT+8","description":"ritical vulnerability has been identified in the React Server Components in Next.js"},"unlisted":false,"nextItem":{"title":"Covid in 2025","permalink":"/blog/covid-in-2025"}}')},25534:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});var r=i(3873),s=i(74848),t=i(28453);const l={title:"Critical Security Vulnerability in Next.js",slug:"nextjs-rsc-cve",authors:[{name:"Tom Lam",title:"Software Developer",url:"https://github.com/ShigureDD",image_url:"https://github.com/ShigureDD.png"}],tags:["next.js","cve","rsc"],date:"2025-12-09 GMT+8",description:"ritical vulnerability has been identified in the React Server Components in Next.js"},o="CVE-2025-66478: Critical Security Vulnerability in Next.js",a={authorsImageUrls:[void 0]},c=[{value:"Overview",id:"overview",level:2},{value:"Impact",id:"impact",level:2},{value:"Affected Versions",id:"affected-versions",level:2},{value:"Fixed Versions",id:"fixed-versions",level:2},{value:"Solution: How to Fix the Vulnerability",id:"solution-how-to-fix-the-vulnerability",level:2},{value:"Step 1: Check Your Current Version",id:"step-1-check-your-current-version",level:3},{value:"Step 2: Choose Your Upgrade Path",id:"step-2-choose-your-upgrade-path",level:3},{value:"Option A: Automated Fix Tool (Recommended)",id:"option-a-automated-fix-tool-recommended",level:4},{value:"Option B: Manual Upgrade",id:"option-b-manual-upgrade",level:4},{value:"Option C: Upgrade to Latest Stable (Recommended for New Projects)",id:"option-c-upgrade-to-latest-stable-recommended-for-new-projects",level:4},{value:"Step 3: Handle Canary Releases",id:"step-3-handle-canary-releases",level:3},{value:"Step 4: Update Dependencies",id:"step-4-update-dependencies",level:3},{value:"Step 5: Verify the Fix",id:"step-5-verify-the-fix",level:3},{value:"Step 6: Test Your Application",id:"step-6-test-your-application",level:3},{value:"Step 7: Deploy the Patched Version",id:"step-7-deploy-the-patched-version",level:3},{value:"Step 8: Rotate Secrets (Critical)",id:"step-8-rotate-secrets-critical",level:3},{value:"Step 9: Monitor for Issues",id:"step-9-monitor-for-issues",level:3},{value:"Important Notes",id:"important-notes",level:3},{value:"Troubleshooting",id:"troubleshooting",level:3},{value:"Resources",id:"resources",level:2},{value:"Discovery",id:"discovery",level:2}];function d(e){const n={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Published:"})," December 3rd, 2025",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"CVSS Score:"})," 10.0 (Critical)",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Source:"})," ",(0,s.jsx)(n.a,{href:"https://nextjs.org/blog/CVE-2025-66478",children:"Next.js Security Advisory"})]}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.p,{children:["A critical vulnerability has been identified in the React Server Components (RSC) protocol that can allow remote code execution (RCE) when processing attacker-controlled requests in unpatched environments. This vulnerability originates from the upstream React implementation (",(0,s.jsx)(n.a,{href:"https://www.cve.org/CVERecord?id=CVE-2025-55182",children:"CVE-2025-55182"}),")."]}),"\n",(0,s.jsx)(n.h2,{id:"impact",children:"Impact"}),"\n",(0,s.jsx)(n.p,{children:"The vulnerable RSC protocol allowed untrusted inputs to influence server-side execution behavior. Under specific conditions, an attacker could craft requests that trigger unintended server execution paths, resulting in remote code execution."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"All users should upgrade to a patched version immediately."})}),"\n",(0,s.jsx)(n.h2,{id:"affected-versions",children:"Affected Versions"}),"\n",(0,s.jsx)(n.p,{children:"Applications using React Server Components with the App Router are affected when running:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Next.js 15.x"}),"\n",(0,s.jsx)(n.li,{children:"Next.js 16.x"}),"\n",(0,s.jsx)(n.li,{children:"Next.js 14.3.0-canary.77 and later canary releases"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Not affected:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Next.js 13.x"}),"\n",(0,s.jsx)(n.li,{children:"Next.js 14.x stable"}),"\n",(0,s.jsx)(n.li,{children:"Pages Router applications"}),"\n",(0,s.jsx)(n.li,{children:"Edge Runtime"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"fixed-versions",children:"Fixed Versions"}),"\n",(0,s.jsx)(n.p,{children:"The vulnerability is fully resolved in:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"15.0.5"})," (for 15.0.x)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"15.1.9"})," (for 15.1.x)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"15.2.6"})," (for 15.2.x)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"15.3.6"})," (for 15.3.x)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"15.4.8"})," (for 15.4.x)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"15.5.7"})," (for 15.5.x)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"16.0.7"})," (for 16.0.x)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"15.6.0-canary.58"})," (for 15.x canary releases)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"16.1.0-canary.12"})," (for 16.x canary releases)"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"solution-how-to-fix-the-vulnerability",children:"Solution: How to Fix the Vulnerability"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-check-your-current-version",children:"Step 1: Check Your Current Version"}),"\n",(0,s.jsx)(n.p,{children:"First, verify which version of Next.js you're currently using:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm list next\n# or\ncat package.json | grep next\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-2-choose-your-upgrade-path",children:"Step 2: Choose Your Upgrade Path"}),"\n",(0,s.jsx)(n.h4,{id:"option-a-automated-fix-tool-recommended",children:"Option A: Automated Fix Tool (Recommended)"}),"\n",(0,s.jsx)(n.p,{children:"The easiest way to fix the vulnerability is using the official automated tool:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npx fix-react2shell-next\n"})}),"\n",(0,s.jsx)(n.p,{children:"This interactive tool will:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Check your current Next.js version"}),"\n",(0,s.jsx)(n.li,{children:"Determine the correct patched version for your release line"}),"\n",(0,s.jsxs)(n.li,{children:["Automatically update your ",(0,s.jsx)(n.code,{children:"package.json"})," and ",(0,s.jsx)(n.code,{children:"package-lock.json"})]}),"\n",(0,s.jsx)(n.li,{children:"Provide clear instructions for next steps"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"option-b-manual-upgrade",children:"Option B: Manual Upgrade"}),"\n",(0,s.jsx)(n.p,{children:"If you prefer to upgrade manually, install the appropriate patched version based on your current release:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# For Next.js 15.0.x\nnpm install next@15.0.5\n\n# For Next.js 15.1.x\nnpm install next@15.1.9\n\n# For Next.js 15.2.x\nnpm install next@15.2.6\n\n# For Next.js 15.3.x\nnpm install next@15.3.6\n\n# For Next.js 15.4.x\nnpm install next@15.4.8\n\n# For Next.js 15.5.x\nnpm install next@15.5.7\n\n# For Next.js 16.0.x\nnpm install next@16.0.7\n"})}),"\n",(0,s.jsx)(n.h4,{id:"option-c-upgrade-to-latest-stable-recommended-for-new-projects",children:"Option C: Upgrade to Latest Stable (Recommended for New Projects)"}),"\n",(0,s.jsx)(n.p,{children:"If you're starting fresh or can upgrade to the latest version:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install next@latest\n"})}),"\n",(0,s.jsx)(n.p,{children:"This will install the latest patched version (16.0.7 or newer)."}),"\n",(0,s.jsx)(n.h3,{id:"step-3-handle-canary-releases",children:"Step 3: Handle Canary Releases"}),"\n",(0,s.jsx)(n.p,{children:"If you're using canary releases:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Next.js 14.3.0-canary.77 or later:"})," Downgrade to stable 14.x"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install next@14\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Using canary for PPR (Partial Prerendering):"})," Update to a patched canary"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install next@15.6.0-canary.58   # for 15.x canary\nnpm install next@16.1.0-canary.12   # for 16.x canary\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"step-4-update-dependencies",children:"Step 4: Update Dependencies"}),"\n",(0,s.jsx)(n.p,{children:"After installing the patched version, update your lock file:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install\n# or\nnpm update\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-5-verify-the-fix",children:"Step 5: Verify the Fix"}),"\n",(0,s.jsx)(n.p,{children:"Confirm that the patched version is installed:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm list next\n"})}),"\n",(0,s.jsx)(n.p,{children:'You should see one of the patched versions listed in the "Fixed Versions" section above.'}),"\n",(0,s.jsx)(n.h3,{id:"step-6-test-your-application",children:"Step 6: Test Your Application"}),"\n",(0,s.jsx)(n.p,{children:"Before deploying, thoroughly test your application:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run build\nnpm run start\n"})}),"\n",(0,s.jsx)(n.p,{children:"Test critical functionality, especially:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Server Components"}),"\n",(0,s.jsx)(n.li,{children:"API routes"}),"\n",(0,s.jsx)(n.li,{children:"Server Actions"}),"\n",(0,s.jsx)(n.li,{children:"Data fetching"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"step-7-deploy-the-patched-version",children:"Step 7: Deploy the Patched Version"}),"\n",(0,s.jsx)(n.p,{children:"Deploy your updated application to production immediately:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Example for Vercel\nvercel --prod\n\n# Example for other platforms\ngit add package.json package-lock.json\ngit commit -m "security: upgrade Next.js to patch CVE-2025-66478"\ngit push\n'})}),"\n",(0,s.jsx)(n.h3,{id:"step-8-rotate-secrets-critical",children:"Step 8: Rotate Secrets (Critical)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"If your application was online and unpatched as of December 4th, 2025 at 1:00 PM PT"}),", you must rotate all secrets:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Environment Variables:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Database credentials"}),"\n",(0,s.jsx)(n.li,{children:"API keys"}),"\n",(0,s.jsx)(n.li,{children:"OAuth secrets"}),"\n",(0,s.jsx)(n.li,{children:"JWT secrets"}),"\n",(0,s.jsx)(n.li,{children:"Encryption keys"}),"\n",(0,s.jsx)(n.li,{children:"Any other sensitive credentials"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"How to Rotate:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Update values in your hosting platform (Vercel, AWS, etc.)"}),"\n",(0,s.jsxs)(n.li,{children:["Update ",(0,s.jsx)(n.code,{children:".env"})," files (never commit these!)"]}),"\n",(0,s.jsx)(n.li,{children:"Update CI/CD pipeline secrets"}),"\n",(0,s.jsx)(n.li,{children:"Update third-party service API keys"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Priority Order:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Start with most critical secrets (database, payment processors)"}),"\n",(0,s.jsx)(n.li,{children:"Then rotate API keys and OAuth credentials"}),"\n",(0,s.jsx)(n.li,{children:"Finally, rotate less critical keys"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"step-9-monitor-for-issues",children:"Step 9: Monitor for Issues"}),"\n",(0,s.jsx)(n.p,{children:"After deployment:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Monitor application logs for errors"}),"\n",(0,s.jsx)(n.li,{children:"Check error tracking (Sentry, etc.)"}),"\n",(0,s.jsx)(n.li,{children:"Verify all features work correctly"}),"\n",(0,s.jsx)(n.li,{children:"Monitor for any suspicious activity"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"important-notes",children:"Important Notes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"No Workaround Available:"})," There is no workaround for this vulnerability. Upgrading is the only solution."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Immediate Action Required:"})," This is a critical RCE vulnerability. Upgrade as soon as possible."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Backward Compatibility:"})," Patched versions maintain backward compatibility with your existing code."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Breaking Changes:"})," The security patches do not introduce breaking changes to the Next.js API."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.p,{children:"If you encounter issues during upgrade:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Clear cache:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"rm -rf .next\nrm -rf node_modules\nnpm install\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Check for conflicting dependencies:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm ls react react-dom\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Review Next.js migration guide:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://nextjs.org/docs/app/building-your-application/upgrading/version-15",children:"Next.js 15 Upgrade Guide"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://nextjs.org/docs/app/building-your-application/upgrading/version-16",children:"Next.js 16 Upgrade Guide"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/vercel/next.js/security/advisories/GHSA-9qr9-h5gf-34mp",children:"Next.js Security Advisory (CVE-2025-66478)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.cve.org/CVERecord?id=CVE-2025-55182",children:"React Security Advisory (CVE-2025-55182)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components",children:"React Blog: Critical Security Vulnerability"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/vercel-labs/fix-react2shell-next",children:"Fix Tool Repository"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"discovery",children:"Discovery"}),"\n",(0,s.jsxs)(n.p,{children:["Discovered and responsibly disclosed by ",(0,s.jsx)(n.a,{href:"https://github.com/lachlan2k",children:"Lachlan Davidson"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>o});var r=i(96540);const s={},t=r.createContext(s);function l(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);